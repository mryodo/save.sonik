
A0=[21.2, 29.0, 19.9; 
    9.0, 48.8, 22.4;
    49.8, 62.2, 7.8];

u=[75; 82; 125];

v=[85, 150, 45];

    [n,m]=size(A0);

    A0(A0==0)=1e-6;

    coefs=zeros(1, n*m);
    c=zeros(1, n*m);
    for i=1:n
        for j=1:m
            coefs
    Q=diag(1./coefs);

    A=zeros(n+m, n*m);
    for i=1:n
        for j=(m*(i-1)+1):(m*i)
            A(i,j)=1;
        end
    end
    for i=1:m
        for j=i:n:(n*m)
            A(n+i,j)=1;
        end
    end
    rhs=[u' v];

    clear model;
    model.Q=sparse(Q);
    model.A=sparse(A);
    model.rhs=rhs;
    model.obj=c;
    model.sense='<';

    results = gurobi(model);
    A=reshape(results.x, [n,m])';